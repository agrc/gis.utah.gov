name: 'SGID Index'

on:
  schedule:
    - cron: '0 6 * * 1-5'
  workflow_dispatch:

jobs:
  check:
    name: 'Update SGID Index'
    runs-on: ubuntu-latest

    steps:
      - name: ‚¨áÔ∏è Set up code
        uses: actions/checkout@v2
        
      - name: üêç Install Python
        uses: actions/setup-python@v2.3.1
        with:
          python-version: 3.9          
          cache: pip
          cache-dependency-path: "scripts/requirements.txt"

      - name: Update SGID Index
        uses: technote-space/create-pr-action@v2.0.33
        env:
          GIS_DRIVE_API_CREDENTIALS: ${{ secrets.SA }}
        with:
          EXECUTE_COMMANDS: |
            pip install -r scripts/requirements.txt
            python scripts/datatable.py
          COMMIT_MESSAGE: 'chore: :package: update sgid-index'
          PR_BRANCH_PREFIX: 'bot/'
          PR_BRANCH_NAME: 'sgid-index-update-${PR_ID}'
          PR_TITLE: 'sgid-index update'
